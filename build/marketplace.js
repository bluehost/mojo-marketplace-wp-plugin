(()=>{var e={154:e=>{function t(){return e.exports=t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},t.apply(this,arguments)}e.exports=t},184:(e,t)=>{var a;!function(){"use strict";var n={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var a=arguments[t];if(a){var o=typeof a;if("string"===o||"number"===o)e.push(a);else if(Array.isArray(a)){if(a.length){var l=r.apply(null,a);l&&e.push(l)}}else if("object"===o)if(a.toString===Object.prototype.toString)for(var s in a)n.call(a,s)&&a[s]&&e.push(s);else e.push(a.toString())}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):void 0===(a=function(){return r}.apply(t,[]))||(e.exports=a)}()}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,a),o.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.wp.element,t=window.wp.apiFetch;var n=a.n(t),r=a(184),o=a.n(r);const l=window.React;function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},s.apply(this,arguments)}var c,i;(i=c||(c={})).Pop="POP",i.Push="PUSH",i.Replace="REPLACE";const u="popstate";function m(e){return{usr:e.state,key:e.key}}function d(e,t,a,n){return void 0===a&&(a=null),s({pathname:"string"==typeof e?e:e.pathname,search:"",hash:""},"string"==typeof t?p(t):t,{state:a,key:t&&t.key||n||Math.random().toString(36).substr(2,8)})}function p(e){let t={};if(e){let a=e.indexOf("#");a>=0&&(t.hash=e.substr(a),e=e.substr(0,a));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}var h;function f(e,t){if(!1===e||null==e)throw new Error(t)}!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(h||(h={}));const g=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",y=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;const v="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},{useState:E,useEffect:w,useLayoutEffect:k,useDebugValue:C}=l;function b(e){const t=e.getSnapshot,a=e.value;try{const e=t();return!v(a,e)}catch(e){return!0}}"undefined"==typeof window||void 0===window.document||window.document.createElement;"useSyncExternalStore"in l&&l.useSyncExternalStore;const S=l.createContext(null),x=l.createContext(null),N=l.createContext({outlet:null,matches:[]});function P(){return null!=l.useContext(x)}function A(){return P()||f(!1),l.useContext(x).location}function L(){P()||f(!1);let{basename:e,navigator:t}=l.useContext(S),{matches:a}=l.useContext(N),{pathname:n}=A(),r=JSON.stringify(function(e){return e.filter(((t,a)=>0===a||!t.route.index&&t.pathnameBase!==e[a-1].pathnameBase))}(a).map((e=>e.pathnameBase))),o=l.useRef(!1);return l.useEffect((()=>{o.current=!0})),l.useCallback((function(a,l){if(void 0===l&&(l={}),!o.current)return;if("number"==typeof a)return void t.go(a);let c=function(e,t,a,n){void 0===n&&(n=!1);let r,o="string"==typeof e?p(e):s({},e),l=""===e||""===o.pathname,c=l?"/":o.pathname;if(n||null==c)r=a;else{let e=t.length-1;if(c.startsWith("..")){let t=c.split("/");for(;".."===t[0];)t.shift(),e-=1;o.pathname=t.join("/")}r=e>=0?t[e]:"/"}let i=function(e,t){void 0===t&&(t="/");let{pathname:a,search:n="",hash:r=""}="string"==typeof e?p(e):e,o=a?a.startsWith("/")?a:function(e,t){let a=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?a.length>1&&a.pop():"."!==e&&a.push(e)})),a.length>1?a.join("/"):"/"}(a,t):t;return{pathname:o,search:g(n),hash:y(r)}}(o,r),u=c&&"/"!==c&&c.endsWith("/"),m=(l||"."===c)&&a.endsWith("/");return i.pathname.endsWith("/")||!u&&!m||(i.pathname+="/"),i}(a,JSON.parse(r),n,"path"===l.relative);"/"!==e&&(c.pathname="/"===c.pathname?e:[e,c.pathname].join("/").replace(/\/\/+/g,"/")),(l.replace?t.replace:t.push)(c,l.state,l)}),[e,t,r,n])}var O,T;function j(e){let{basename:t="/",children:a=null,location:n,navigationType:r=c.Pop,navigator:o,static:s=!1}=e;P()&&f(!1);let i=t.replace(/^\/*/,"/"),u=l.useMemo((()=>({basename:i,navigator:o,static:s})),[i,o,s]);"string"==typeof n&&(n=p(n));let{pathname:m="/",search:d="",hash:h="",state:g=null,key:y="default"}=n,v=l.useMemo((()=>{let e=function(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let a=t.endsWith("/")?t.length-1:t.length,n=e.charAt(a);return n&&"/"!==n?null:e.slice(a)||"/"}(m,i);return null==e?null:{pathname:e,search:d,hash:h,state:g,key:y}}),[i,m,d,h,g,y]);return null==v?null:l.createElement(S.Provider,{value:u},l.createElement(x.Provider,{children:a,value:{location:v,navigationType:r}}))}function B(e){let{basename:t,children:a,window:n}=e,r=l.useRef();var o;null==r.current&&(r.current=(void 0===(o={window:n,v5Compat:!0})&&(o={}),function(e,t,a,n){void 0===n&&(n={});let{window:r=document.defaultView,v5Compat:o=!1}=n,l=r.history,s=c.Pop,i=null;function p(){s=c.Pop,i&&i({action:s,location:h.location})}let h={get action(){return s},get location(){return e(r,l)},listen(e){if(i)throw new Error("A history only accepts one active listener");return r.addEventListener(u,p),i=e,()=>{r.removeEventListener(u,p),i=null}},createHref:e=>t(r,e),push:function(e,t){s=c.Push;let n=d(h.location,e,t);a&&a(n,e);let u=m(n),p=h.createHref(n);try{l.pushState(u,"",p)}catch(e){r.location.assign(p)}o&&i&&i({action:s,location:n})},replace:function(e,t){s=c.Replace;let n=d(h.location,e,t);a&&a(n,e);let r=m(n),u=h.createHref(n);l.replaceState(r,"",u),o&&i&&i({action:s,location:n})},go:e=>l.go(e)};return h}((function(e,t){let{pathname:a="/",search:n="",hash:r=""}=p(e.location.hash.substr(1));return d("",{pathname:a,search:n,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){let a=e.document.querySelector("base"),n="";if(a&&a.getAttribute("href")){let t=e.location.href,a=t.indexOf("#");n=-1===a?t:t.slice(0,a)}return n+"#"+("string"==typeof t?t:function(e){let{pathname:t="/",search:a="",hash:n=""}=e;return a&&"?"!==a&&(t+="?"===a.charAt(0)?a:"?"+a),n&&"#"!==n&&(t+="#"===n.charAt(0)?n:"#"+n),t}(t))}),(function(e,t){!function(e,t){if(!e){"undefined"!=typeof console&&console.warn(t);try{throw new Error(t)}catch(e){}}}("/"===e.pathname.charAt(0),"relative pathnames are not supported in hash history.push("+JSON.stringify(t)+")")}),o)));let s=r.current,[i,h]=l.useState({action:s.action,location:s.location});return l.useLayoutEffect((()=>s.listen(h)),[s]),l.createElement(j,{basename:t,children:a,location:i.location,navigationType:i.action,navigator:s})}l.Component,function(e){e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator"}(O||(O={})),function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"}(T||(T={})),new Promise((()=>{})),l.Component;const R=window.wp.components;var U=a(154),M=a.n(U);const I=t=>{let{item:a,Components:n,methods:r,constants:o}=t;const l=e=>{e.data=e.data||{},e.data.page=window.location.href,r.apiFetch({url:`${o.resturl}${o.eventendpoint}`,method:"POST",data:e})},s=e=>{e.keycode&&ENTER!==e.keycode||l({action:"newfold-marketplaceitem-click",data:{element:"button",label:e.target.innerText,productId:a.id}})},c=e=>{e.keycode&&ENTER!==e.keycode||l({action:"newfold-marketplaceitem-click",data:{element:"a",href:e.target.getAttribute("href"),label:e.target.innerText,productId:a.id}})};return r.useEffect((()=>{const e=document.getElementById(`marketplace-item-${a.id}`),t=Array.from(e.querySelectorAll("button")),n=Array.from(e.querySelectorAll("a"));return t.length&&t.forEach((e=>{"close"!==e.getAttribute("data-action")&&(e.addEventListener("click",s),e.addEventListener("onkeydown",s))})),n.length&&n.forEach((e=>{"close"!==e.getAttribute("data-action")&&(e.addEventListener("click",c),e.addEventListener("onkeydown",c))})),()=>{t.length&&t.forEach((e=>{"close"!==e.getAttribute("data-action")&&(e.removeEventListener("click",s),e.removeEventListener("onkeydown",s))})),n.length&&n.forEach((e=>{"close"!==e.getAttribute("data-action")&&(e.removeEventListener("click",c),e.removeEventListener("onkeydown",c))}))}}),[]),(0,e.createElement)(n.Card,{className:`marketplace-item marketplace-item-${a.id}`,id:`marketplace-item-${a.id}`},a.productThumbnailUrl&&(0,e.createElement)(n.CardMedia,null,(0,e.createElement)("img",{src:a.productThumbnailUrl,alt:a.name+" thumbnail"})),(0,e.createElement)(n.CardHeader,null,(0,e.createElement)("h2",null,a.name),a.price>0&&a.price_formatted&&(0,e.createElement)("div",{className:"price"},a.price_formatted)),a.description&&(0,e.createElement)(n.CardBody,{dangerouslySetInnerHTML:{__html:a.description}}),(0,e.createElement)(n.CardFooter,null,(t=>{let a,r;return t.primaryUrl&&t.primaryCallToAction&&(a=(0,e.createElement)(n.Button,M()({variant:"primary",className:"primary-cta",target:"_blank",href:t.primaryUrl},o.supportsCTB&&t.clickToBuyId?{"data-action":"load-nfd-ctb","data-ctb-id":t.clickToBuyId}:{}),t.primaryCallToAction)),t.secondaryCallToAction&&t.secondaryUrl&&(r=(0,e.createElement)(n.Button,{variant:"secondary",className:"secondary-cta",target:"_blank",href:t.secondaryUrl},t.secondaryCallToAction)),(0,e.createElement)(e.Fragment,null,a,r)})(a)))},D=t=>{let{marketplaceItems:a,currentCount:n,category:r,Components:o,methods:l,constants:s,saveCategoryDisplayCount:c}=t;const[i,u]=l.useState(n),[m,d]=l.useState([]),[p,h]=l.useState([]);return l.useEffect((()=>{d(((e,t)=>e.filter((e=>e.categories.includes(t))))(a,r))}),[]),l.useEffect((()=>{h(((e,t)=>{let a=0;return e.filter((e=>(a++,a<=t)))})(m,i))}),[m,i]),l.useEffect((()=>{c(r,i)}),[i]),(0,e.createElement)("div",{className:"marketplaceList"},(0,e.createElement)("div",{className:"grid col2"},p.length>0&&p.map((t=>(0,e.createElement)(I,{key:t.hash,item:t,Components:o,methods:l,constants:s}))),!p.length&&(0,e.createElement)("p",null,"Sorry, no marketplace items. Please, try again later.")),m&&m.length>i&&(0,e.createElement)("div",{style:{display:"flex",margin:"1rem 0"}},(0,e.createElement)(o.Button,{onClick:()=>{u(i+s.perPage)},variant:"primary",className:"align-center",style:{margin:"auto"}},"Load More")))},W=t=>{let{width:a,height:n,customClass:r}=t;return(0,e.createElement)("div",{className:"newfold-marketplace-skeleton "+r,style:{width:a||"100%",height:n||"auto"}})},F=t=>{let{width:a,height:n}=t;return(0,e.createElement)(W,{width:a||"500px",height:n||"45px",customClass:"filterbar-skeleton"})},H=()=>(0,e.createElement)("div",{className:"marketplace-item-skeleton"},(0,e.createElement)("div",{className:"skeleton-item-media"},(0,e.createElement)(W,{width:"100%",height:"auto",customClass:"marketplace-item-img-skeleton"})),(0,e.createElement)("div",{className:"skeleton-item-body"},(0,e.createElement)(W,{width:"170px",height:"20px",customClass:"marketplace-item-title-skeleton"}),(0,e.createElement)(W,{width:"100%",height:"10px",customClass:"marketplace-item-desc-skeleton"}),(0,e.createElement)(W,{width:"100%",height:"10px",customClass:"marketplace-item-desc-skeleton"}),(0,e.createElement)(W,{width:"70%",height:"10px",customClass:"marketplace-item-desc-skeleton"}),(0,e.createElement)(W,{width:"80px",height:"36px",customClass:"marketplace-item-button-skeleton"}))),_=t=>{let{items:a=6,filter:n=!0,containerClassNames:r="grid col2"}=t;return(0,e.createElement)("div",{className:"newfold-marketplace-isloading"},n&&(0,e.createElement)(F,null),(0,e.createElement)("div",{className:r},(t=>{const a=t;let n=[];for(let e=0;e<a;e++)n.push(e);return n.map((()=>(0,e.createElement)(H,null)))})(a)))},$=t=>{let{methods:a,constants:n,Components:r,...o}=t;const[l,s]=a.useState(!0),[c,i]=a.useState(!1),[u,m]=a.useState([]),[d,p]=a.useState([]),[h,f]=a.useState(),g=a.useNavigate(),y=a.useLocation();a.useEffect((()=>{a.apiFetch({url:`${n.resturl}/newfold-marketplace/v1/marketplace`}).then((e=>{if(e.hasOwnProperty("data")){const t=e.data;p(t),m(v(t))}else i(!0)}))}),[]),a.useEffect((()=>{l||(d.length<1?i(!0):i(!1))}),[d]),a.useEffect((()=>{if(l&&u.length>1){if(y.pathname.includes("marketplace/")){const e=y.pathname.substring(y.pathname.lastIndexOf("/")+1);e&&0==u.filter((t=>t.name===e)).length?f("featured"):f(e)}s(!1)}}),[u]);const v=e=>{if(!e.length)return[];let t=[],a=new Set;return e.forEach((e=>{e.categories.forEach((e=>{a.add(e)}))})),a.forEach((e=>{t.push({name:e.toLowerCase().replaceAll(" ","-"),title:e,currentCount:n.perPage})})),t.sort((function(e,t){return"featured"===e.name?-1:"featured"===t.name?1:e.name<t.name?-1:e.name>t.name?1:0})),t},E=(e,t)=>{let a=[...u];a.forEach((a=>{a.name===e&&(a.currentCount=t)})),m(a)};return(0,e.createElement)("div",{className:a.classnames("newfold-marketplace-wrapper")},l&&(0,e.createElement)(_,null),c&&(0,e.createElement)("h3",null,"Oops, there was an error loading the marketplace, please try again later."),!l&&!c&&(0,e.createElement)(r.TabPanel,{className:"newfold-marketplace-tabs",activeClass:"current-tab",orientation:"vertical",initialTabName:h,onSelect:e=>{g("/marketplace/"+e,{replace:!0})},tabs:u},(t=>(0,e.createElement)(D,{marketplaceItems:d,category:t.title,Components:r,methods:a,constants:n,currentCount:t.currentCount,saveCategoryDisplayCount:E}))))},q=()=>(0,e.createElement)(B,null,(0,e.createElement)("div",{className:"wppw"},(0,e.createElement)($,{Components:{Button:R.Button,Card:R.Card,CardBody:R.CardBody,CardFooter:R.CardFooter,CardHeader:R.CardHeader,CardMedia:R.CardMedia,TabPanel:R.TabPanel,Spinner:R.Spinner},constants:{resturl:window.mojo.restUrl,eventendpoint:"/newfold-data/v1/events/",perPage:12,supportsCTB:!1},methods:{apiFetch:n(),classnames:o(),useEffect:l.useEffect,useState:e.useState,useNavigate:L,useLocation:A}}))),J=window.wp.domReady;a.n(J)()((()=>(0,e.render)((0,e.createElement)(q,null),document.getElementById("mojo-marketplace-app"))))})()})();