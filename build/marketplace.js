(()=>{var e={184:(e,t)=>{var r;!function(){"use strict";var a={}.hasOwnProperty;function n(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var o=typeof r;if("string"===o||"number"===o)e.push(r);else if(Array.isArray(r)){if(r.length){var l=n.apply(null,r);l&&e.push(l)}}else if("object"===o){if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]")){e.push(r.toString());continue}for(var c in r)a.call(r,c)&&r[c]&&e.push(c)}}}return e.join(" ")}e.exports?(n.default=n,e.exports=n):void 0===(r=function(){return n}.apply(t,[]))||(e.exports=r)}()}},t={};function r(a){var n=t[a];if(void 0!==n)return n.exports;var o=t[a]={exports:{}};return e[a](o,o.exports,r),o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.wp.element,t=window.wp.apiFetch;var a=r.n(t),n=r(184),o=r.n(n);const l=window.React;function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},c.apply(this,arguments)}var i,s;(s=i||(i={})).Pop="POP",s.Push="PUSH",s.Replace="REPLACE";const u="popstate";function d(e,t){if(!1===e||null==e)throw new Error(t)}function m(e,t){return{usr:e.state,key:e.key,idx:t}}function p(e,t,r,a){return void 0===r&&(r=null),c({pathname:"string"==typeof e?e:e.pathname,search:"",hash:""},"string"==typeof t?f(t):t,{state:r,key:t&&t.key||a||Math.random().toString(36).substr(2,8)})}function h(e){let{pathname:t="/",search:r="",hash:a=""}=e;return r&&"?"!==r&&(t+="?"===r.charAt(0)?r:"?"+r),a&&"#"!==a&&(t+="#"===a.charAt(0)?a:"#"+a),t}function f(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let a=e.indexOf("?");a>=0&&(t.search=e.substr(a),e=e.substr(0,a)),e&&(t.pathname=e)}return t}var g;function y(e,t,r,a){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(a)+"].  Please separate it out to the `to."+r+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(g||(g={})),new Set(["lazy","caseSensitive","path","id","index","children"]);const v=e=>e.join("/").replace(/\/\/+/g,"/"),E=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",w=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";class k extends Error{}const b=["post","put","patch","delete"],C=(new Set(b),["get",...b]);new Set(C),new Set([301,302,303,307,308]),new Set([307,308]),"undefined"!=typeof window&&void 0!==window.document&&window.document.createElement,Symbol("deferred");const S="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},{useState:x,useEffect:P,useLayoutEffect:N,useDebugValue:O}=l;function R(e){const t=e.getSnapshot,r=e.value;try{const e=t();return!S(r,e)}catch(e){return!0}}"undefined"==typeof window||void 0===window.document||window.document.createElement;"useSyncExternalStore"in l&&l.useSyncExternalStore;const A=l.createContext(null),L=l.createContext(null),j=l.createContext({outlet:null,matches:[]});function _(){return null!=l.useContext(L)}function U(){return _()||d(!1),l.useContext(L).location}function T(){_()||d(!1);let{basename:e,navigator:t}=l.useContext(A),{matches:r}=l.useContext(j),{pathname:a}=U(),n=JSON.stringify(function(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}(r).map((e=>e.pathnameBase))),o=l.useRef(!1);return l.useEffect((()=>{o.current=!0})),l.useCallback((function(r,l){if(void 0===l&&(l={}),!o.current)return;if("number"==typeof r)return void t.go(r);let i=function(e,t,r,a){let n;void 0===a&&(a=!1),"string"==typeof e?n=f(e):(n=c({},e),d(!n.pathname||!n.pathname.includes("?"),y("?","pathname","search",n)),d(!n.pathname||!n.pathname.includes("#"),y("#","pathname","hash",n)),d(!n.search||!n.search.includes("#"),y("#","search","hash",n)));let o,l=""===e||""===n.pathname,i=l?"/":n.pathname;if(a||null==i)o=r;else{let e=t.length-1;if(i.startsWith("..")){let t=i.split("/");for(;".."===t[0];)t.shift(),e-=1;n.pathname=t.join("/")}o=e>=0?t[e]:"/"}let s=function(e,t){void 0===t&&(t="/");let{pathname:r,search:a="",hash:n=""}="string"==typeof e?f(e):e,o=r?r.startsWith("/")?r:function(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?r.length>1&&r.pop():"."!==e&&r.push(e)})),r.length>1?r.join("/"):"/"}(r,t):t;return{pathname:o,search:E(a),hash:w(n)}}(n,o),u=i&&"/"!==i&&i.endsWith("/"),m=(l||"."===i)&&r.endsWith("/");return s.pathname.endsWith("/")||!u&&!m||(s.pathname+="/"),s}(r,JSON.parse(n),a,"path"===l.relative);"/"!==e&&(i.pathname="/"===i.pathname?e:v([e,i.pathname])),(l.replace?t.replace:t.push)(i,l.state,l)}),[e,t,n,a])}class B extends l.Component{constructor(e){super(e),this.state={location:e.location,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location?{error:e.error,location:e.location}:{error:e.error||t.error,location:t.location}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error?React.createElement(j.Provider,{value:this.props.routeContext},React.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}var D,F,I,M,W;function $(e){let{basename:t="/",children:r=null,location:a,navigationType:n=i.Pop,navigator:o,static:c=!1}=e;_()&&d(!1);let s=t.replace(/^\/*/,"/"),u=l.useMemo((()=>({basename:s,navigator:o,static:c})),[s,o,c]);"string"==typeof a&&(a=f(a));let{pathname:m="/",search:p="",hash:h="",state:g=null,key:y="default"}=a,v=l.useMemo((()=>{let e=function(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,a=e.charAt(r);return a&&"/"!==a?null:e.slice(r)||"/"}(m,s);return null==e?null:{location:{pathname:e,search:p,hash:h,state:g,key:y},navigationType:n}}),[s,m,p,h,g,y,n]);return null==v?null:l.createElement(A.Provider,{value:u},l.createElement(L.Provider,{children:r,value:v}))}!function(e){e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator"}(D||(D={})),function(e){e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator"}(F||(F={})),function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"}(I||(I={})),new Promise((()=>{}));class H extends l.Component{constructor(e){super(e),this.state={error:null}}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e,t){console.error("<Await> caught the following error during render",e,t)}render(){let{children:e,errorElement:t,resolve:r}=this.props,a=null,n=I.pending;if(r instanceof Promise)if(this.state.error){I.error;let e=this.state.error;Promise.reject().catch((()=>{})),Object.defineProperty(a,"_tracked",{get:()=>!0}),Object.defineProperty(a,"_error",{get:()=>e})}else r._tracked?void 0!==a._error?I.error:void 0!==a._data?I.success:I.pending:(I.pending,Object.defineProperty(r,"_tracked",{get:()=>!0}),r.then((e=>Object.defineProperty(r,"_data",{get:()=>e})),(e=>Object.defineProperty(r,"_error",{get:()=>e}))));else I.success,Promise.resolve(),Object.defineProperty(a,"_tracked",{get:()=>!0}),Object.defineProperty(a,"_data",{get:()=>r});if(n===I.error&&a._error instanceof AbortedDeferredError)throw neverSettledPromise;if(n===I.error&&!t)throw a._error;if(n===I.error)return React.createElement(AwaitContext.Provider,{value:a,children:t});if(n===I.success)return React.createElement(AwaitContext.Provider,{value:a,children:e});throw a}}function q(e){let{basename:t,children:r,window:a}=e,n=l.useRef();var o;null==n.current&&(n.current=(void 0===(o={window:a,v5Compat:!0})&&(o={}),function(e,t,r,a){void 0===a&&(a={});let{window:n=document.defaultView,v5Compat:o=!1}=a,l=n.history,s=i.Pop,f=null,g=y();function y(){return(l.state||{idx:null}).idx}function v(){s=i.Pop;let e=y(),t=null==e?null:e-g;g=e,f&&f({action:s,location:w.location,delta:t})}function E(e){let t="null"!==n.location.origin?n.location.origin:n.location.href,r="string"==typeof e?e:h(e);return d(t,"No window.location.(origin|href) available to create URL for href: "+r),new URL(r,t)}null==g&&(g=0,l.replaceState(c({},l.state,{idx:g}),""));let w={get action(){return s},get location(){return e(n,l)},listen(e){if(f)throw new Error("A history only accepts one active listener");return n.addEventListener(u,v),f=e,()=>{n.removeEventListener(u,v),f=null}},createHref:e=>t(n,e),createURL:E,encodeLocation(e){let t=E(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){s=i.Push;let a=p(w.location,e,t);r&&r(a,e),g=y()+1;let c=m(a,g),u=w.createHref(a);try{l.pushState(c,"",u)}catch(e){n.location.assign(u)}o&&f&&f({action:s,location:w.location,delta:1})},replace:function(e,t){s=i.Replace;let a=p(w.location,e,t);r&&r(a,e),g=y();let n=m(a,g),c=w.createHref(a);l.replaceState(n,"",c),o&&f&&f({action:s,location:w.location,delta:0})},go:e=>l.go(e)};return w}((function(e,t){let{pathname:r="/",search:a="",hash:n=""}=f(e.location.hash.substr(1));return p("",{pathname:r,search:a,hash:n},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){let r=e.document.querySelector("base"),a="";if(r&&r.getAttribute("href")){let t=e.location.href,r=t.indexOf("#");a=-1===r?t:t.slice(0,r)}return a+"#"+("string"==typeof t?t:h(t))}),(function(e,t){!function(e,t){if(!e){"undefined"!=typeof console&&console.warn(t);try{throw new Error(t)}catch(e){}}}("/"===e.pathname.charAt(0),"relative pathnames are not supported in hash history.push("+JSON.stringify(t)+")")}),o)));let s=n.current,[g,y]=l.useState({action:s.action,location:s.location});return l.useLayoutEffect((()=>s.listen(y)),[s]),l.createElement($,{basename:t,children:r,location:g.location,navigationType:g.action,navigator:s})}"undefined"!=typeof window&&void 0!==window.document&&window.document.createElement,function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmitImpl="useSubmitImpl",e.UseFetcher="useFetcher"}(M||(M={})),function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(W||(W={}));const J=window.wp.components;function z(){return z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},z.apply(this,arguments)}const V=t=>{let{item:r,Components:a,methods:n,constants:o}=t;const l=e=>{e.data=e.data||{},e.data.page=window.location.href,n.apiFetch({url:`${o.resturl}${o.eventendpoint}`,method:"POST",data:e})},c=e=>{e.keycode&&ENTER!==e.keycode||l({action:"newfold-marketplaceitem-click",data:{element:"button",label:e.target.innerText,productId:r.id}})},i=e=>{e.keycode&&ENTER!==e.keycode||l({action:"newfold-marketplaceitem-click",data:{element:"a",href:e.target.getAttribute("href"),label:e.target.innerText,productId:r.id}})};return n.useEffect((()=>{const e=document.getElementById(`marketplace-item-${r.id}`),t=Array.from(e.querySelectorAll("button")),a=Array.from(e.querySelectorAll("a"));return t.length&&t.forEach((e=>{"close"!==e.getAttribute("data-action")&&(e.addEventListener("click",c),e.addEventListener("onkeydown",c))})),a.length&&a.forEach((e=>{"close"!==e.getAttribute("data-action")&&(e.addEventListener("click",i),e.addEventListener("onkeydown",i))})),()=>{t.length&&t.forEach((e=>{"close"!==e.getAttribute("data-action")&&(e.removeEventListener("click",c),e.removeEventListener("onkeydown",c))})),a.length&&a.forEach((e=>{"close"!==e.getAttribute("data-action")&&(e.removeEventListener("click",i),e.removeEventListener("onkeydown",i))}))}}),[]),(0,e.createElement)(a.Card,{className:`marketplace-item marketplace-item-${r.id} ${r.full_price?"product-has-full-price":""}`,id:`marketplace-item-${r.id}`},r.productThumbnailUrl&&(0,e.createElement)(a.CardMedia,null,(0,e.createElement)("img",{src:r.productThumbnailUrl,alt:r.name+" thumbnail"})),(0,e.createElement)(a.CardHeader,null,(0,e.createElement)("h2",null,r.name),(t=>{let r,a,n;return t.price>0&&t.price_formatted&&(a=(0,e.createElement)("div",{className:"price"},t.price_formatted),t.full_price>0&&t.full_price_formatted?(n=(0,e.createElement)("s",{className:"price full-price"},t.full_price_formatted),r=(0,e.createElement)("div",{className:"price-wrap has-full-price"},n,a)):r=(0,e.createElement)("div",{className:"price-wrap"},a)),r})(r)),r.description&&(0,e.createElement)(a.CardBody,{dangerouslySetInnerHTML:{__html:r.description}}),(0,e.createElement)(a.CardFooter,null,(t=>{let r,n;return t.primaryUrl&&t.primaryCallToAction&&(r=(0,e.createElement)(a.Button,z({variant:"primary",className:"primary-cta",target:"_blank",href:t.primaryUrl},o.supportsCTB&&t.clickToBuyId?{"data-action":"load-nfd-ctb","data-ctb-id":t.clickToBuyId}:{}),t.primaryCallToAction)),t.secondaryCallToAction&&t.secondaryUrl&&(n=(0,e.createElement)(a.Button,{variant:"secondary",className:"secondary-cta",target:"_blank",href:t.secondaryUrl},t.secondaryCallToAction)),(0,e.createElement)(e.Fragment,null,r,n)})(r)))},G=t=>{let{marketplaceItems:r,currentCount:a,category:n,Components:o,methods:l,constants:c,saveCategoryDisplayCount:i}=t;const[s,u]=l.useState(a),[d,m]=l.useState([]),[p,h]=l.useState([]);return l.useEffect((()=>{m(((e,t)=>e.filter((e=>e.categories.includes(t.title))))(r,n))}),[]),l.useEffect((()=>{h(((e,t)=>{let r=0;return e.filter((e=>(r++,r<=t)))})(d,s))}),[d,s]),l.useEffect((()=>{i(n.name,s)}),[s]),(0,e.createElement)("div",{className:`marketplace-list marketplace-list-${n.name}`},(0,e.createElement)("div",{className:"grid col2"},p.length>0&&p.map((t=>(0,e.createElement)(V,{key:t.hash,item:t,Components:o,methods:l,constants:c}))),!p.length&&(0,e.createElement)("p",null,"Sorry, no marketplace items. Please, try again later.")),d&&d.length>s&&(0,e.createElement)("div",{style:{display:"flex",margin:"1rem 0"}},(0,e.createElement)(o.Button,{onClick:()=>{u(s+c.perPage)},variant:"primary",className:"align-center",style:{margin:"auto"}},"Load More")))},K=t=>{let{width:r,height:a,customClass:n}=t;return(0,e.createElement)("div",{className:"newfold-marketplace-skeleton "+n,style:{width:r||"100%",height:a||"auto"}})},Q=t=>{let{width:r,height:a}=t;return(0,e.createElement)(K,{width:r||"500px",height:a||"45px",customClass:"filterbar-skeleton"})},X=()=>(0,e.createElement)("div",{className:"marketplace-item-skeleton"},(0,e.createElement)("div",{className:"skeleton-item-media"},(0,e.createElement)(K,{width:"100%",height:"auto",customClass:"marketplace-item-img-skeleton"})),(0,e.createElement)("div",{className:"skeleton-item-body"},(0,e.createElement)(K,{width:"170px",height:"20px",customClass:"marketplace-item-title-skeleton"}),(0,e.createElement)(K,{width:"100%",height:"10px",customClass:"marketplace-item-desc-skeleton"}),(0,e.createElement)(K,{width:"100%",height:"10px",customClass:"marketplace-item-desc-skeleton"}),(0,e.createElement)(K,{width:"70%",height:"10px",customClass:"marketplace-item-desc-skeleton"}),(0,e.createElement)(K,{width:"80px",height:"36px",customClass:"marketplace-item-button-skeleton"}))),Y=t=>{let{items:r=6,filter:a=!0,containerClassNames:n="grid col2"}=t;return(0,e.createElement)("div",{className:"newfold-marketplace-isloading"},a&&(0,e.createElement)(Q,null),(0,e.createElement)("div",{className:n},(t=>{const r=t;let a=[];for(let e=0;e<r;e++)a.push(e);return a.map((t=>(0,e.createElement)(X,{key:t})))})(r)))},Z=t=>{let{methods:r,constants:a,Components:n,...o}=t;const[l,c]=r.useState(!0),[i,s]=r.useState(!1),[u,d]=r.useState([]),[m,p]=r.useState([]),[h,f]=r.useState(),g=r.useNavigate(),y=r.useLocation();r.useEffect((()=>{r.apiFetch({url:`${a.resturl}/newfold-marketplace/v1/marketplace`}).then((e=>{e.hasOwnProperty("categories")&&e.hasOwnProperty("products")?(p(e.products.data),d(v(e.categories.data))):s(!0)}))}),[]),r.useEffect((()=>{l||(m.length<1?s(!0):s(!1))}),[m]),r.useEffect((()=>{if(l&&u.length>1){if(y.pathname.includes("marketplace/")){const e=y.pathname.substring(y.pathname.lastIndexOf("/")+1);e&&0==u.filter((t=>t.name===e)).length?f(0):f(e)}c(!1),w()}}),[u]);const v=e=>{if(!e.length)return[];let t=[];return e.forEach((e=>{e.currentCount=a.perPage,e.className="newfold-marketplace-tab-"+e.name,e.products_count>0&&t.push(e)})),t},E=(e,t)=>{let r=[...u];r.forEach((r=>{r.name===e&&(r.currentCount=t)})),d(r)},w=()=>{u&&u.forEach((e=>{if(e.styles&&!document.querySelector('[data-styleid="'+e.className+'"]')){const t=document.createElement("style");t.textContent=e.styles,t.dataset.styleid=e.className,document.head.appendChild(t)}}))};return(0,e.createElement)("div",{className:r.classnames("newfold-marketplace-wrapper")},l&&(0,e.createElement)(Y,null),i&&(0,e.createElement)("h3",null,"Oops, there was an error loading the marketplace, please try again later."),!l&&!i&&(0,e.createElement)(n.TabPanel,{className:"newfold-marketplace-tabs",activeClass:"current-tab",orientation:"horizontal",initialTabName:h,onSelect:e=>{g("/marketplace/"+e,{replace:!0})},tabs:u},(t=>(0,e.createElement)(G,{marketplaceItems:m,category:t,Components:n,methods:r,constants:a,currentCount:t.currentCount,saveCategoryDisplayCount:E}))))},ee=()=>(0,e.createElement)(q,null,(0,e.createElement)("div",{className:"mojo-app"},(0,e.createElement)(Z,{Components:{Button:J.Button,Card:J.Card,CardBody:J.CardBody,CardFooter:J.CardFooter,CardHeader:J.CardHeader,CardMedia:J.CardMedia,TabPanel:J.TabPanel,Spinner:J.Spinner},constants:{resturl:window.mojo.restUrl,eventendpoint:"/newfold-data/v1/events/",perPage:12,supportsCTB:!1},methods:{apiFetch:a(),classnames:o(),useEffect:l.useEffect,useState:e.useState,useNavigate:T,useLocation:U}}))),te=window.wp.domReady;r.n(te)()((()=>(0,e.render)((0,e.createElement)(ee,null),document.getElementById("mojo-marketplace-app"))))})()})();