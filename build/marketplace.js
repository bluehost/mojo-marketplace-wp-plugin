(()=>{var e={184:(e,t)=>{var a;!function(){"use strict";var r={}.hasOwnProperty;function n(){for(var e=[],t=0;t<arguments.length;t++){var a=arguments[t];if(a){var o=typeof a;if("string"===o||"number"===o)e.push(a);else if(Array.isArray(a)){if(a.length){var l=n.apply(null,a);l&&e.push(l)}}else if("object"===o)if(a.toString===Object.prototype.toString)for(var c in a)r.call(a,c)&&a[c]&&e.push(c);else e.push(a.toString())}}return e.join(" ")}e.exports?(n.default=n,e.exports=n):void 0===(a=function(){return n}.apply(t,[]))||(e.exports=a)}()}},t={};function a(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,a),o.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.wp.element,t=window.wp.apiFetch;var r=a.n(t),n=a(184),o=a.n(n);const l=window.React,c=window.wp.components,s=t=>{let{item:a,Components:r,methods:n,constants:o}=t;const l=e=>{e.data=e.data||{},e.data.page=window.location.href,n.apiFetch({url:`${o.resturl}${o.eventendpoint}`,method:"POST",data:e})},c=e=>{e.keycode&&ENTER!==e.keycode||l({action:"newfold-marketplaceitem-click",data:{element:"button",label:e.target.innerText,productId:a.id}})},s=e=>{e.keycode&&ENTER!==e.keycode||l({action:"newfold-marketplaceitem-click",data:{element:"a",href:e.target.getAttribute("href"),label:e.target.innerText,productId:a.id}})};return n.useEffect((()=>{const e=document.getElementById(`marketplace-item-${a.id}`),t=Array.from(e.querySelectorAll("button")),r=Array.from(e.querySelectorAll("a"));return t.length&&t.forEach((e=>{"close"!==e.getAttribute("data-action")&&(e.addEventListener("click",c),e.addEventListener("onkeydown",c))})),r.length&&r.forEach((e=>{"close"!==e.getAttribute("data-action")&&(e.addEventListener("click",s),e.addEventListener("onkeydown",s))})),()=>{t.length&&t.forEach((e=>{"close"!==e.getAttribute("data-action")&&(e.removeEventListener("click",c),e.removeEventListener("onkeydown",c))})),r.length&&r.forEach((e=>{"close"!==e.getAttribute("data-action")&&(e.removeEventListener("click",s),e.removeEventListener("onkeydown",s))}))}}),[]),(0,e.createElement)(r.Card,{className:`marketplace-item marketplace-item-${a.id}`,id:`marketplace-item-${a.id}`},a.productThumbnailUrl&&(0,e.createElement)(r.CardMedia,null,(0,e.createElement)("img",{src:a.productThumbnailUrl,alt:a.name+" thumbnail"})),(0,e.createElement)(r.CardHeader,null,(0,e.createElement)("h3",null,a.name),a.price>0&&a.price_formatted&&(0,e.createElement)("em",{className:"price"},a.price_formatted)),a.description&&(0,e.createElement)(r.CardBody,{dangerouslySetInnerHTML:{__html:a.description}}),(0,e.createElement)(r.CardFooter,null,(t=>{let a,n;return o.supportsCTB&&t.clickToBuyId&&t.primaryCallToAction?a=(0,e.createElement)(r.Button,{variant:"primary",className:"primary-cta ctb-cta","data-action":"load-nfd-ctb","data-ctb-id":t.clickToBuyId},t.primaryCallToAction):t.primaryUrl&&t.primaryCallToAction&&(a=(0,e.createElement)(r.Button,{variant:"primary",className:"primary-cta",target:"_blank",href:t.primaryUrl},t.primaryCallToAction)),t.secondaryCallToAction&&t.secondaryUrl&&(n=(0,e.createElement)(r.Button,{variant:"secondary",className:"secondary-cta",target:"_blank",href:t.secondaryUrl},t.secondaryCallToAction)),(0,e.createElement)(e.Fragment,null,a,n)})(a)))},i=t=>{let{marketplaceItems:a,currentCount:r,category:n,Components:o,methods:l,constants:c,saveCategoryDisplayCount:i}=t;const[d,m]=l.useState(r),[u,p]=l.useState([]),[f,y]=l.useState([]);return l.useEffect((()=>{p(((e,t)=>e.filter((e=>e.categories.includes(t))))(a,n))}),[]),l.useEffect((()=>{y(((e,t)=>{let a=0;return e.filter((e=>(a++,a<=t)))})(u,d))}),[u,d]),l.useEffect((()=>{i(n,d)}),[d]),(0,e.createElement)("div",{className:"marketplaceList"},(0,e.createElement)("div",{className:"grid col2"},f.length>0&&f.map((t=>(0,e.createElement)(s,{key:t.hash,item:t,Components:o,methods:l,constants:c}))),!f.length&&(0,e.createElement)("p",null,"Sorry, no marketplace items. Please, try again later.")),u&&u.length>d&&(0,e.createElement)("div",{style:{display:"flex",margin:"1rem 0"}},(0,e.createElement)(o.Button,{onClick:()=>{m(d+c.perPage)},variant:"primary",className:"align-center",style:{margin:"auto"}},"Load More")))},d=t=>{let{methods:a,constants:r,Components:n,...o}=t;const[l,c]=a.useState(!0),[s,d]=a.useState(!1),[m,u]=a.useState([]),[p,f]=a.useState([]),[y,E]=a.useState();a.useEffect((()=>{a.apiFetch({url:`${r.resturl}/newfold-marketplace/v1/marketplace`}).then((e=>{if(c(!1),e.hasOwnProperty("data")){const t=e.data;f(t),u(h(t))}else d(!0)}))}),[]),a.useEffect((()=>{l||(p.length<1?d(!0):d(!1))}),[p]);const h=e=>{if(!e.length)return[];let t=[],a=new Set;return e.forEach((e=>{e.categories.forEach((e=>{a.add(e)}))})),a.forEach((e=>{t.push({name:e,title:e,currentCount:r.perPage})})),t.sort((function(e,t){return"featured"===e.name.toLowerCase()?-1:"featured"===t.name.toLowerCase()?1:e.name.toLowerCase()<t.name.toLowerCase()?-1:e.name.toLowerCase()>t.name.toLowerCase()?1:0})),t},g=(e,t)=>{let a=[...m];a.forEach((a=>{a.name===e&&(a.currentCount=t)})),u(a)};return(0,e.createElement)("div",{className:a.classnames("newfold-marketplace-wrapper")},l&&(0,e.createElement)(n.Spinner,null),s&&(0,e.createElement)("h3",null,"Oops, there was an error loading the marketplace, please try again later."),!l&&!s&&(0,e.createElement)(n.TabPanel,{className:"newfold-marketplace-tabs",activeClass:"current-tab",orientation:"vertical",initialTabName:y,tabs:m},(t=>(0,e.createElement)(i,{marketplaceItems:p,category:t.name,Components:n,methods:a,constants:r,currentCount:t.currentCount,saveCategoryDisplayCount:g}))))},m=()=>(0,e.createElement)("div",{className:"wppw"},(0,e.createElement)(d,{Components:{Button:c.Button,Card:c.Card,CardBody:c.CardBody,CardFooter:c.CardFooter,CardHeader:c.CardHeader,CardMedia:c.CardMedia,TabPanel:c.TabPanel,Spinner:c.Spinner},constants:{resturl:window.mojo.restUrl,eventendpoint:"/newfold-data/v1/events/",perPage:12,supportsCTB:!1},methods:{apiFetch:r(),classnames:o(),useEffect:l.useEffect,useState:e.useState}})),u=window.wp.domReady;a.n(u)()((()=>(0,e.render)((0,e.createElement)(m,null),document.getElementById("mojo-marketplace-app"))))})()})();